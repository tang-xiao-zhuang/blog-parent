<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--namespace：给哪个接口配置的映射，写接口的全限定类名-->
<mapper namespace="com.zhuang.blog.dao.ArticleDao">
    <update id="updateViewCount" parameterType="long">
        update ms_article set view_counts = view_counts + 1 where id = #{articleId}
    </update>

    <select id="newArticles" resultType="com.zhuang.blog.pojo.Article" parameterType="integer">
        select id,title from ms_article ORDER BY create_date DESC limit #{limit};
    </select>

    <select id="listArticle" resultMap="ArticleMap" parameterType="integer">
        select *
        from ms_article
        ORDER BY create_date desc, weight limit #{start}, #{end}
    </select>

    <select id="hotArticle" resultType="com.zhuang.blog.pojo.Article" parameterType="integer">
        select id,title from ms_article ORDER BY view_counts DESC limit #{limit};
    </select>

    <select id="listArchives" resultType="com.zhuang.blog.entity.Articles">
        SELECT
            FROM_UNIXTIME( create_date / 1000, '%Y' ) YEAR,
            FROM_UNIXTIME( create_date / 1000, '%m' ) MONTH,
            COUNT( 1 ) count
        FROM
            ms_article
        GROUP BY
            YEAR,
            MONTH;
    </select>

    <select id="findById" resultMap="ArticleMap" parameterType="long">
        select * from ms_article where id = #{articleId}
    </select>

    <resultMap id="ArticleMap" type="com.zhuang.blog.pojo.Article">
        <id property="id" column="id"/>
        <result property="commentCounts" column="comment_counts"/>
        <result property="createDate" column="create_date"/>
        <result property="summary" column="summary"/>
        <result property="title" column="title"/>
        <result property="viewCounts" column="view_counts"/>
        <result property="weight" column="weight"/>
        <result property="authorId" column="author_id"/>
        <result property="bodyId" column="body_id"/>
        <result property="categoryId" column="category_id"/>
    </resultMap>

</mapper>
